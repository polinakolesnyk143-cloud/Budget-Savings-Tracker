<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Budget & Savings Tracker</title>
  <meta name="description" content="–ü—Ä–æ—Å—Ç–∏–π Budget & Savings Tracker ‚Äî —Ç–µ–º–Ω–∞/—Å–≤—ñ—Ç–ª–∞ —Ç–µ–º–∏, –ª–æ–∫–∞–ª—å–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è, –≥—Ä–∞—Ñ—ñ–∫, —Ü—ñ–ª—ñ" />
  <!-- Tailwind Play CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    // Tailwind –∫–æ–Ω—Ñ—ñ–≥ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–∏—Ö –∫–æ–ª—å–æ—Ä—ñ–≤ —ñ dark mode class-based
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: '#06b6d4', // cyan-500
            accent: '#7c3aed'   // violet-600
         }
        }
      }
    }
  </script>
  <style>
    /* –ù–µ–≤–µ–ª–∏–∫—ñ CSS-–¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è */
    .glass { background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02)); backdrop-filter: blur(6px); }
  </style>
  
</head>
<body class="antialiased bg-white text-slate-800 dark:bg-slate-900 dark:text-slate-100">
  <div class="min-h-screen p-6 max-w-6xl mx-auto">
    <!-- Header -->
    <header class="flex items-center justify-between gap-4 mb-6">
      <div class="flex items-center gap-3">
        <div class="w-12 h-12 rounded-lg bg-gradient-to-br from-primary to-accent flex items-center justify-center text-white">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-6 h-6 fill-current">
    <path d="M3 17h2v-7H3v7zm4 0h2V3H7v14zm4 0h2v-4h-2v4zm4 0h2V9h-2v8zm4 0h2v-2h-2v2z"/>
  </svg>
</div>

        <div>
          <h1 data-i18n="title" class="text-lg font-semibold">Budget & Savings Tracker</h1>
          <p data-i18n="subtitle" class="text-sm text-slate-500 dark:text-slate-400">Your personal finance tracker</p>
        </div>
      </div>

      <div class="flex items-center gap-3">
        <!-- Theme toggle -->
        <button id="themeToggle" data-i18n="theme" class="px-3 py-2 rounded-md glass hover:scale-105 transition">Theme</button>
        <button id="exportCsv" data-i18n="exportCSV" class="px-3 py-2 rounded-md bg-primary text-white hover:opacity-90">–ï–∫—Å–ø–æ—Ä—Ç CSV</button>
       <a href="https://buy.stripe.com/4gM8wIc5a0Ss6m1chLcZa00"
   id="upgradeBtn"
   target="_blank"
   rel="noopener noreferrer"
   data-i18n="upgrade"
   class="px-3 py-2 rounded-md border border-slate-300 dark:border-slate-700 hover:bg-primary hover:text-white transition">
  Upgrade to Pro üí≥
</a>

		<button id="menuToggle" class="p-2 rounded-md hover:bg-slate-200 dark:hover:bg-slate-700">
  <!-- –Ü–∫–æ–Ω–∫–∞ –±—É—Ä–≥–µ—Ä-–º–µ–Ω—é -->
  <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
  </svg>
</button>

      </div>
    </header>

    <!-- Main grid -->
    <main class="grid grid-cols-1 lg:grid-cols-3 gap-6">

      <!-- Left column: Form + Goals -->
      <section class="lg:col-span-1 space-y-6">
        <div class="p-4 rounded-2xl glass">
          <h2 data-i18n="addTransaction" class="text-sm font-medium mb-2">Add Transaction</h2>
          
<form id="txForm" class="space-y-3">
  <div class="grid grid-cols-2 gap-2">
    <input id="txIncome" type="number" step="0.01" data-i18n-placeholder="incomePlaceholder" placeholder="Income amount" class="px-3 py-2 rounded-md bg-transparent border border-slate-200 dark:border-slate-700" />
    <input id="txExpense" type="number" step="0.01" data-i18n-placeholder="expensePlaceholder" placeholder="Expense amount" class="px-3 py-2 rounded-md bg-transparent border border-slate-200 dark:border-slate-700" />
  </div>
  <input id="txCategory" type="text" data-i18n-placeholder="categoryPlaceholder" placeholder="Category (e.g. food, salary)" class="w-full px-3 py-2 rounded-md bg-transparent border border-slate-200 dark:border-slate-700" />
  <input id="txDesc" type="text" data-i18n-placeholder="descPlaceholder" placeholder="Description (optinal)" class="w-full px-3 py-2 rounded-md bg-transparent border border-slate-200 dark:border-slate-700" />
  <div class="flex gap-2">
    <input id="txDate" type="date" class="px-3 py-2 rounded-md bg-transparent border border-slate-200 dark:border-slate-700" />
    <button type="submit" class="ml-auto px-4 py-2 rounded-md bg-accent text-white" data-i18n="addBtn">Add</button>
  </div>
</form>
        </div>
		<!-- Multi Savings Goals Section -->
<div class="p-4 rounded-2xl glass" id="multiGoalsSection">
  <h3 class="text-sm font-medium mb-3" data-i18n="savingsGoal">Savings goals</h3>

  <!-- Add new goal form -->
  <form id="addGoalForm" class="flex flex-col gap-2 mb-4">
    <input id="newGoalName" type="text" placeholder="Goal name (e.g. Car, Dream)" 
           class="px-3 py-2 rounded-md bg-transparent border border-slate-200 dark:border-slate-700" />
    <input id="newGoalAmount" type="number" placeholder="Goal amount" 
           class="px-3 py-2 rounded-md bg-transparent border border-slate-200 dark:border-slate-700" />
    <button type="submit" class="px-4 py-2 rounded-md bg-accent text-white hover:opacity-90">
      Add new goal
    </button>
  </form>

  <!-- Goals list -->
  <div id="goalsContainer" class="space-y-4"></div>
</div>


        <div class="p-4 rounded-2xl glass">
          <h3 class="text-sm font-medium mb-2" data-i18n="quickFilters">Quick filters</h3>
          <div class="flex gap-2 flex-wrap">
            <button class="px-3 py-1 rounded-md border" data-i18n="filterAll">All</button>
            <button class="px-3 py-1 rounded-md border" data-i18n="filterWeek">Week</button>
            <button class="px-3 py-1 rounded-md border" data-i18n="filterMonth">Month</button>
            <button class="px-3 py-1 rounded-md border" data-i18n="filterIncome">Income</button>
            <button class="px-3 py-1 rounded-md border" data-i18n="filterExpenses">Expenses</button>
          </div>
        </div>
      </section>

      <!-- Middle: Dashboard (balance + chart) -->
      <section class="lg:col-span-2 space-y-6">
        <div class="p-4 rounded-2xl glass flex items-center justify-between">
          <div>
            <div class="text-sm text-slate-400" data-i18n="balanceLabel">Current balance</div>
            <div id="balance" class="text-2xl font-bold">0 ‚Ç¥</div>
            <div class="text-sm text-slate-400">
  <span data-i18n="incomeLabel">Income:</span> 
  <span id="totalIncome">0 ‚Ç¥</span> ‚Äî 
  <span data-i18n="expensesLabel">Expenses:</span> 
  <span id="totalExpense">0 ‚Ç¥</span>
</div>

          </div>
          <div class="w-72">
            <!-- –ü—Ä–æ—Å—Ç–∏–π –∫—Ä—É–≥–æ–≤–∏–π –ø—Ä–æ–≥—Ä–µ—Å (SVG) -->
            <svg viewBox="0 0 36 36" class="w-28 h-28">
              <path class="text-slate-200 dark:text-slate-800" stroke-width="2" fill="none" stroke="currentColor" d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831"/>
              <path id="circleArc" stroke-width="2.8" fill="none" stroke-linecap="round" stroke="url(#g)" d="M18 2.0845
                a 15.9155 15.9155 0 0 1 0 31.831
                a 15.9155 15.9155 0 0 1 0 -31.831" stroke-dasharray="0 100"/>
              <defs>
                <linearGradient id="g" x1="0" x2="1">
                  <stop offset="0%" stop-color="#06b6d4" />
                  <stop offset="100%" stop-color="#7c3aed" />
                </linearGradient>
              </defs>
              <text x="50%" y="50%" dominant-baseline="middle" text-anchor="middle" class="text-sm font-medium" fill="currentColor"><tspan id="percentText">0%</tspan></text>
            </svg>
          </div>
        </div>

        <div class="p-4 rounded-2xl glass">
         <div class="flex items-center justify-between mb-3 relative">
  <h3 class="text-sm font-medium" data-i18n="chartTitle">Income/Spending Chart</h3>
  
  <!-- –Ω–æ–≤–∏–π –æ–±–≥–æ—Ä—Ç—É—é—á–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
  <div class="relative">
    <button id="chartFilterBtn" class="px-3 py-1 rounded-md border border-slate-300 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800 transition">
      Select period
    </button>

    <!-- Dropdown menu ‚Üì –¢–ï–ü–ï–† –°–¢–ê–í–ò–ú–û absolute –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ -->
    <div id="chartMenu" class="hidden absolute top-full right-0 mt-1 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-md p-2 text-sm shadow-lg z-50">
      <button class="chartOption block w-full text-left px-2 py-1 hover:bg-slate-100 dark:hover:bg-slate-700" data-period="today" data-i18n="periodToday">Today</button>
      <button class="chartOption block w-full text-left px-2 py-1 hover:bg-slate-100 dark:hover:bg-slate-700" data-period="7days" data-i18n="period7">Last 7 Days</button>
      <button class="chartOption block w-full text-left px-2 py-1 hover:bg-slate-100 dark:hover:bg-slate-700" data-period="month" data-i18n="periodMonth">This Month</button>
      <button class="chartOption block w-full text-left px-2 py-1 hover:bg-slate-100 dark:hover:bg-slate-700" data-period="all" data-i18n="periodAll">All Time</button>
    </div>
  </div>
</div>


          <div id="chart" class="w-full h-40 flex items-end gap-2"></div>
        </div>

        <div class="p-4 rounded-2xl glass">
          <h3 class="text-sm font-medium mb-3" data-i18n="recentTransactions">Recent Transactions</h3>
          <div id="txList" class="space-y-2 max-h-64 overflow-auto"></div>
        </div>
		<div class="p-4 rounded-2xl glass" id="customGoalsSection">
  <h3 class="text-sm font-medium mb-3">Custom Saving Categories</h3>

  <form id="addCategoryForm" class="flex gap-2 mb-3">
    <input id="catName" type="text" placeholder="Category (e.g. food, leisure)" class="flex-1 px-2 py-1 rounded-md bg-transparent border border-slate-300 dark:border-slate-700" />
    <input id="catAmount" type="number" step="0.01" placeholder="Amount" class="w-32 px-2 py-1 rounded-md bg-transparent border border-slate-300 dark:border-slate-700 text-right" />
    <button type="submit" class="px-3 py-1 bg-accent text-white rounded-md">Add</button>
  </form>

  <div id="categoryList" class="space-y-2 text-sm"></div>
</div>

      </section>

    </main>

    <footer class="mt-6 text-center text-sm text-slate-400" data-i18n="footer">Made with ‚ô• ‚Äî –ø—Ä–æ—Å—Ç–∏–π demo. –ú–æ–∂–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ –æ–ø–ª–∞—Ç—É —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ.</footer>
  </div>
  <!-- Sidebar –º–µ–Ω—é (–∫—Ä–∞—â–µ –ø–æ–º—ñ—Å—Ç–∏—Ç–∏ –ø–µ—Ä–µ–¥ Script) -->
<div id="sideMenu" class="fixed top-0 right-0 w-64 h-full bg-white dark:bg-slate-800 shadow-lg transform translate-x-full transition-transform duration-300 z-50">
  <div class="p-4 border-b dark:border-slate-700 flex justify-between items-center">
    <span data-i18n="menuTitle" class="font-semibold">Menu</span>
    <button id="closeMenu" class="text-xl">&times;</button>
  </div>
  <div class="p-4 flex flex-col gap-3 text-sm">
    <button id="signupBtn" class="text-left hover:text-primary" data-i18n="signup">üîê Sign up/Log in</button>
    <div class="text-left">
      <button id="langMenuBtn" class="hover:text-primary w-full text-left" data-i18n="language">üåê Language ‚ñæ</button>
      <div id="langOptions" class="hidden flex flex-row ml-4 mt-2 gap-2 text-sm">
  <button id="langEn" class="px-2 py-1 rounded-md border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700">
    English
  </button>
  <button id="langUk" class="px-2 py-1 rounded-md border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-700">
    –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞
  </button>
</div>

    </div>
    <button class="text-left hover:text-primary" data-i18n="currency">üí∂ Currency</button>
    <button class="text-left hover:text-primary" data-i18n="about">‚Ñπ About this program</button>
    <button class="text-left hover:text-primary" data-i18n="feedback">üì¨ Give feedback</button>
    <button class="text-left hover:text-primary" data-i18n="contact">üìû Contacts</button>
  </div>
</div>


  <script>
  // –ü—Ä–æ—Å—Ç–∏–π frontend —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª: –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π —É localStorage, –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –±–∞–ª–∞–Ω—Å—É, –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–æ–≥—Ä–µ—Å—É
  const txForm = document.getElementById('txForm');
  const txList = document.getElementById('txList');
  const balanceEl = document.getElementById('balance');
  const totalIncomeEl = document.getElementById('totalIncome');
  const totalExpenseEl = document.getElementById('totalExpense');
  const circleArc = document.getElementById('circleArc');
  const percentText = document.getElementById('percentText');
  const chartEl = document.getElementById('chart');

  let transactions = JSON.parse(localStorage.getItem('bs_transactions') || '[]');
  let theme = localStorage.getItem('bs_theme') ||
    (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');

  const themeToggle = document.getElementById('themeToggle');

  function applyTheme(t) {
    if (t === 'dark') {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
    localStorage.setItem('bs_theme', t);
    // update theme button text based on current language later
  }

  applyTheme(theme);

  themeToggle.addEventListener('click', () => {
    theme = document.documentElement.classList.contains('dark') ? 'light' : 'dark';
    applyTheme(theme);
  });

  // Set default date to today
  document.getElementById('txDate').value = new Date().toISOString().slice(0,10);

  function getNextId() {
    if (!transactions || transactions.length === 0) return 1;
    return Math.max(...transactions.map(t => t.id || 0)) + 1;
  }

  let currentChartPeriod = '7days'; 

  function save(){
    localStorage.setItem('bs_transactions', JSON.stringify(transactions));
    render();
    renderChart(currentChartPeriod);
  }

  

const translations = {
  en: {
    title: "Budget & Savings Tracker",
    subtitle: "Your personal finance tracker",
    theme: "Theme",
    exportCSV: "Export CSV",
    upgrade: "Upgrade to Pro",
    addTransaction: "Add Transaction",
    incomePlaceholder: "Income amount",
    expensePlaceholder: "Expense amount",
    categoryPlaceholder: "Category (e.g. food, salary)",
    descPlaceholder: "Description (optional)",
    addBtn: "Add",
    savingsGoal: "Savings goal",
    currentSaved: "Current saved",
    goalLabel: "Goal",
    leftLabel: "Left: ",
    quickFilters: "Quick filters",
    filterAll: "All",
    filterWeek: "Week",
    filterMonth: "Month",
    filterIncome: "Income",
    filterExpenses: "Expenses",
    balanceLabel: "Current balance",
    chartTitle: "Income/Spending Chart",
    periodToday: "Today",
    period7: "Last 7 Days",
    periodMonth: "This Month",
    periodAll: "All Time",
    selectPeriod: "Select period",
    recentTransactions: "Recent Transactions",
    footer: "Made with ‚ô• ‚Äî simple demo. Can integrate payments and server storage.",
    menuTitle: "Menu",
    signup: "üîê Sign up/Log in",
    language: "üåê Language ‚ñæ",
    currency: "üí∂ Currency",
    about: "‚Ñπ About this program",
    feedback: "üì¨ Give feedback",
    contact: "üìû Contacts",
    alert_no_amount: 'Please enter an income or expense amount',
    alert_only_one: 'Add only one ‚Äî either income or expense',
    alert_no_category: 'Please enter a category',
    csv_income: 'Income',
    csv_expense: 'Expense',
    incomeLabel: "Income:",
    expensesLabel: "Expenses:",
    delete: "Delete",
    no_transactions: "No transactions to export"
  },
  uk: {
    title: "–¢—Ä–µ–∫–µ—Ä –±—é–¥–∂–µ—Ç—É —Ç–∞ –∑–∞–æ—â–∞–¥–∂–µ–Ω—å",
    subtitle: "–í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏–π —Ñ—ñ–Ω–∞–Ω—Å–æ–≤–∏–π —Ç—Ä–µ–∫–µ—Ä",
    theme: "–¢–µ–º–∞",
    exportCSV: "–ï–∫—Å–ø–æ—Ä—Ç CSV",
    upgrade: "–û–Ω–æ–≤–∏—Ç–∏ –¥–æ Pro",
    addTransaction: "–î–æ–¥–∞—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é",
    incomePlaceholder: "–°—É–º–∞ –¥–æ—Ö–æ–¥—É",
    expensePlaceholder: "–°—É–º–∞ –≤–∏—Ç—Ä–∞—Ç–∏",
    categoryPlaceholder: "–ö–∞—Ç–µ–≥–æ—Ä—ñ—è (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —ó–∂–∞, –∑–∞—Ä–ø–ª–∞—Ç–∞)",
    descPlaceholder: "–û–ø–∏—Å (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)",
    addBtn: "–î–æ–¥–∞—Ç–∏",
    savingsGoal: "–ú–µ—Ç–∞ –∑–∞–æ—â–∞–¥–∂–µ–Ω—å",
    currentSaved: "–ù–∞–∫–æ–ø–∏—á–µ–Ω–æ",
    goalLabel: "–ú–µ—Ç–∞",
    leftLabel: "–ó–∞–ª–∏—à–∏–ª–æ—Å—å: ",
    quickFilters: "–®–≤–∏–¥–∫—ñ —Ñ—ñ–ª—å—Ç—Ä–∏",
    filterAll: "–í—Å—ñ",
    filterWeek: "–¢–∏–∂–¥–µ–Ω—å",
    filterMonth: "–ú—ñ—Å—è—Ü—å",
    filterIncome: "–î–æ—Ö–æ–¥–∏",
    filterExpenses: "–í–∏—Ç—Ä–∞—Ç–∏",
    balanceLabel: "–ü–æ—Ç–æ—á–Ω–∏–π –±–∞–ª–∞–Ω—Å",
    chartTitle: "–ì—Ä–∞—Ñ—ñ–∫ –¥–æ—Ö–æ–¥—ñ–≤/–≤–∏—Ç—Ä–∞—Ç",
    periodToday: "–°—å–æ–≥–æ–¥–Ω—ñ",
    period7: "–û—Å—Ç–∞–Ω–Ω—ñ 7 –¥–Ω—ñ–≤",
    periodMonth: "–ü–æ—Ç–æ—á–Ω–∏–π –º—ñ—Å—è—Ü—å",
    periodAll: "–ó–∞ –≤–µ—Å—å —á–∞—Å",
    selectPeriod: "–û–±–µ—Ä—ñ—Ç—å –ø–µ—Ä—ñ–æ–¥",
    recentTransactions: "–û—Å—Ç–∞–Ω–Ω—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó",
    footer: "–ó—Ä–æ–±–ª–µ–Ω–æ –∑ ‚ô• ‚Äî –ø—Ä–æ—Å—Ç–∏–π –¥–µ–º–æ. –ú–æ–∂–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä—É–≤–∞—Ç–∏ –æ–ø–ª–∞—Ç—É —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ.",
    menuTitle: "–ú–µ–Ω—é",
    signup: "üîê –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è / –í—Ö—ñ–¥",
    language: "üåê –ú–æ–≤–∞ ‚ñæ",
    currency: "üí∂ –í–∞–ª—é—Ç–∞",
    about: "‚Ñπ –ü—Ä–æ –ø—Ä–æ–≥—Ä–∞–º—É",
    feedback: "üì¨ –í—ñ–¥–≥—É–∫",
    contact: "üìû –ö–æ–Ω—Ç–∞–∫—Ç–∏",
    alert_no_amount: '–í–∫–∞–∂—ñ—Ç—å —Å—É–º—É –¥–æ—Ö–æ–¥—É –∞–±–æ –≤–∏—Ç—Ä–∞—Ç–∏',
    alert_only_one: '–ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ª–∏—à–µ –æ–¥–Ω–µ ‚Äî –∞–±–æ –¥–æ—Ö—ñ–¥, –∞–±–æ –≤–∏—Ç—Ä–∞—Ç—É',
    alert_no_category: '–í–∫–∞–∂—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é',
    csv_income: '–î–æ—Ö—ñ–¥',
    csv_expense: '–í–∏—Ç—Ä–∞—Ç–∞',
    incomeLabel: "–î–æ—Ö–æ–¥–∏:",
    expensesLabel: "–í–∏—Ç—Ä–∞—Ç–∏:",
    delete: "–í–∏–¥–∞–ª–∏—Ç–∏",
    no_transactions: "–ù–µ–º–∞—î —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π –¥–ª—è –µ–∫—Å–ø–æ—Ä—Ç—É"
  }
};

  let currentLang = localStorage.getItem('bs_lang') || 'en';

  function applyLanguage(lang){
    const t = translations[lang] || translations['en'];
    // set document text for any element with data-i18n
    document.querySelectorAll('[data-i18n]').forEach(el => {
      const key = el.getAttribute('data-i18n');
      if(t[key]) el.textContent = t[key];
    });
    // set placeholders for inputs that have data-i18n-placeholder
    document.querySelectorAll('[data-i18n-placeholder]').forEach(inp => {
      const key = inp.getAttribute('data-i18n-placeholder');
      if(t[key]) inp.placeholder = t[key];
    });

    // update some dynamic texts used in scripts
    document.title = t.title || document.title;

    // update theme button text
    const themeBtn = document.getElementById('themeToggle');
    if(themeBtn) themeBtn.textContent = t.theme || themeBtn.textContent;

    // set chartFilterBtn default text
    const chartFilterBtn = document.getElementById('chartFilterBtn');
    if(chartFilterBtn) chartFilterBtn.textContent = t.period7 || chartFilterBtn.textContent;

    localStorage.setItem('bs_lang', lang);
    currentLang = lang;
  }

  applyLanguage(currentLang);

  // Form submit with localized alerts
  txForm.addEventListener('submit', (e) => {
    e.preventDefault();

    const incomeAmount = parseFloat(document.getElementById('txIncome').value) || 0;
    const expenseAmount = parseFloat(document.getElementById('txExpense').value) || 0;
    const category = document.getElementById('txCategory').value.trim();
    const desc = document.getElementById('txDesc').value.trim();
    const date = document.getElementById('txDate').value || new Date().toISOString().slice(0, 10);

    const t = translations[currentLang];

    if (incomeAmount === 0 && expenseAmount === 0) {
      alert(t.alert_no_amount);
      return;
    }

    if (incomeAmount > 0 && expenseAmount > 0) {
      alert(t.alert_only_one);
      return;
    }

    if (!category) {
      alert(t.alert_no_category);
      return;
    }

    let nextId = getNextId();

    if (incomeAmount > 0) {
      transactions.unshift({
        id: nextId,
        type: 'income',
        amount: incomeAmount,
        category,
        desc,
        date
      });
    } else if (expenseAmount > 0) {
      transactions.unshift({
        id: nextId,
        type: 'expense',
        amount: expenseAmount,
        category,
        desc,
        date
      });
    }

    txForm.reset();
    document.getElementById('txDate').value = new Date().toISOString().slice(0, 10);
    save();
  });

  function removeTx(id){
    transactions = transactions.filter(t=>t.id !== id);
    save();
  }

  // ------- Chart menu setup (–º–∞—î –±—É—Ç–∏ –ø–æ–∑–∞ render) -------
  const chartFilterBtn = document.getElementById('chartFilterBtn');
  const chartMenu = document.getElementById('chartMenu');

  if (chartFilterBtn && chartMenu) {
    chartFilterBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      chartMenu.classList.toggle('hidden');
    });

    // –∑–∞–∫—Ä–∏—Ç–∏ –ø—Ä–∏ –∫–ª—ñ–∫—É –∑–∞ –º–µ–∂–∞–º–∏
    document.addEventListener('click', (e) => {
      if (!chartMenu.contains(e.target) && e.target !== chartFilterBtn) {
        chartMenu.classList.add('hidden');
      }
    });

    document.querySelectorAll('.chartOption').forEach(btn => {
      btn.addEventListener('click', () => {
        const period = btn.dataset.period;
        currentChartPeriod = period;
        renderChart(period);
        chartMenu.classList.add('hidden');
        chartFilterBtn.textContent = btn.textContent;
      });
    });
  }

  function render(){
    // totals
   // --- Monthly reset logic ---
const now = new Date();
const currentMonth = now.getMonth();
const currentYear = now.getFullYear();

const monthlyTx = transactions.filter(t => {
  const d = new Date(t.date);
  return d.getMonth() === currentMonth && d.getFullYear() === currentYear;
});

const totalIncome = monthlyTx.filter(t => t.type === 'income' && t.category.toLowerCase() !== 'savings goal').reduce((s, t) => s + t.amount, 0);
const totalExpense = monthlyTx.filter(t => t.type === 'expense' && t.category.toLowerCase() !== 'savings goal').reduce((s, t) => s + t.amount, 0);


    const balance = totalIncome - totalExpense;
    const locale = currentLang === 'uk' ? 'uk-UA' : 'en-IE';
    totalIncomeEl.textContent = totalIncome.toLocaleString(locale, {style:'currency', currency:'EUR'});
    totalExpenseEl.textContent = totalExpense.toLocaleString(locale, {style:'currency', currency:'EUR'});
    balanceEl.textContent = balance.toLocaleString(locale, {style:'currency', currency:'EUR'});

    // txList (–≤–∏–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ä–æ–∑–º—ñ—Ç–∫–∞)
    txList.innerHTML = '';
    transactions.slice(0,50).forEach(t=>{
      const el = document.createElement('div');
      el.className = 'flex items-center justify-between p-2 rounded-md border border-transparent hover:border-slate-200 dark:hover:border-slate-700 transition';
      const sign = t.type === 'income' ? '+' : '-';
      const locale = currentLang === 'uk' ? 'uk-UA' : 'en-IE';
      const amountText = (sign + t.amount.toLocaleString(locale, { style: 'currency', currency: 'EUR' }));
      el.innerHTML = `
        <div>
          <div class="text-sm font-medium">${t.category} <span class="text-xs text-slate-400">‚Ä¢ ${t.date}</span></div>
          <div class="text-xs text-slate-400">${t.desc || ''}</div>
        </div>
        <div class="text-right">
          <div class="text-sm ${t.type==='income'? 'text-green-400' : 'text-red-400'}">
            ${amountText}
          </div>
          <button class="text-xs text-slate-400 mt-1" onclick="removeTx(${t.id})">${translations[currentLang].delete || 'Delete'}</button>

        </div>
      `;
      txList.appendChild(el);
    });
  }

  function renderChart(period = '7days') {
    let filteredDays = [];

    if (period === 'today') {
      const d = new Date().toISOString().slice(0,10);
      filteredDays = [d];
    } else if (period === '7days') {
      for (let i = 6; i >= 0; i--) {
        const d = new Date(); d.setDate(d.getDate() - i);
        filteredDays.push(d.toISOString().slice(0,10));
      }
    } else if (period === 'month') {
      const now = new Date();
      const daysInMonth = new Date(now.getFullYear(), now.getMonth()+1, 0).getDate();
      for (let i = 1; i <= daysInMonth; i++) {
        const d = new Date(now.getFullYear(), now.getMonth(), i);
        filteredDays.push(d.toISOString().slice(0,10));
      }
    } else if (period === 'all') {
      filteredDays = [...new Set(transactions.map(t => t.date))].sort();
    }

    const sums = filteredDays.map(day => {
      const inc = transactions.filter(t => t.date === day && t.type === 'income').reduce((s,t)=>s+t.amount,0);
      const exp = transactions.filter(t => t.date === day && t.type === 'expense').reduce((s,t)=>s+t.amount,0);
      return { day, value: Math.max(0, inc - exp) };
    });

    const max = Math.max(1, ...sums.map(s => s.value));
    chartEl.innerHTML = '';

    sums.forEach(s => {
      const h = Math.round((s.value / max) * 100);
      const bar = document.createElement('div');
      bar.className = 'flex-1 h-full flex flex-col items-center';
      bar.innerHTML = `
        <div class="w-full rounded-t-md" style="height:${h}%; background: linear-gradient(180deg, #06b6d4, #7c3aed);"></div>
        <div class="text-xs mt-2">${s.day.slice(5)}</div>
      `;
      chartEl.appendChild(bar);
    });
  }

  // Export CSV
  document.getElementById('exportCsv').addEventListener('click', ()=>{
    if(transactions.length===0){ alert(translations[currentLang].alert_no_amount); return; }
    const header = ['id','type','amount','category','desc','date'];
    const rows = transactions.map(t => [
      t.id,
      t.type === 'income' ? translations[currentLang].csv_income : translations[currentLang].csv_expense,
      t.amount,
      `"${t.category}"`,
      `"${t.desc || ''}"`,
      t.date
    ].join(';'));

    const csv = [header.join(';'), ...rows].join('\n');
    const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download = 'transactions.csv'; a.click(); URL.revokeObjectURL(url);
  });


  // init
  // --- Custom category allocations ---
let customCategories = JSON.parse(localStorage.getItem('bs_categories') || '[]');
const addCategoryForm = document.getElementById('addCategoryForm');
const categoryList = document.getElementById('categoryList');

function saveCategories() {
  localStorage.setItem('bs_categories', JSON.stringify(customCategories));
  renderCategories();
}

addCategoryForm.addEventListener('submit', (e) => {
  e.preventDefault();
  const name = document.getElementById('catName').value.trim();
  const amount = parseFloat(document.getElementById('catAmount').value) || 0;
  if (!name || amount <= 0) return alert('Enter valid category and amount');
  customCategories.push({ name, allocated: amount });
  addCategoryForm.reset();
  saveCategories();
});

function renderCategories() {
  categoryList.innerHTML = '';
  customCategories.forEach(cat => {
    const spent = transactions
      .filter(t => t.category.toLowerCase() === cat.name.toLowerCase() && t.type === 'expense')
      .reduce((s, t) => s + t.amount, 0);
    const remaining = cat.allocated - spent;
    const el = document.createElement('div');
    el.className = 'flex justify-between p-2 rounded-md border border-slate-200 dark:border-slate-700';
    el.innerHTML = `
      <div>${cat.name}</div>
      <div>${remaining.toLocaleString('en-IE', {style:'currency', currency:'EUR'})} left</div>
    `;
    categoryList.appendChild(el);
  });
}

// integrate category updates with render()
const oldRender = render;
render = function() {
  oldRender();
  renderCategories();
};

  render();
  renderChart(currentChartPeriod);

  // expose removeTx to global for button inline onclick
  window.removeTx = removeTx;
  document.addEventListener("DOMContentLoaded", function () {
  const menuToggle = document.getElementById('menuToggle');
  const closeMenu = document.getElementById('closeMenu');
  const sideMenu = document.getElementById('sideMenu');

  if (menuToggle && sideMenu) {
    menuToggle.addEventListener('click', (e) => {
      e.stopPropagation();
      sideMenu.classList.remove('translate-x-full');
    });
  }

  if (closeMenu && sideMenu) {
    closeMenu.addEventListener('click', () => {
      sideMenu.classList.add('translate-x-full');
    });
  }

  // –ó–∞–∫—Ä–∏—Ç—Ç—è –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –º–µ–Ω—é
  document.addEventListener('click', (e) => {
    if (!sideMenu.contains(e.target) && e.target !== menuToggle) {
      sideMenu.classList.add('translate-x-full');
    }
  });
});

// LANGUAGE MENU: toggle options and set language buttons
const langMenuBtn = document.getElementById('langMenuBtn');
const langOptions = document.getElementById('langOptions');
if(langMenuBtn){
  langMenuBtn.addEventListener('click', (e)=>{ e.stopPropagation(); langOptions.classList.toggle('hidden'); });
  document.addEventListener('click', (e)=>{ if(!langOptions.contains(e.target) && e.target !== langMenuBtn) langOptions.classList.add('hidden'); });
}

const langEnBtn = document.getElementById('langEn');
const langUkBtn = document.getElementById('langUk');
if(langEnBtn) langEnBtn.addEventListener('click', ()=>{ applyLanguage('en'); langOptions.classList.add('hidden'); render(); });
if(langUkBtn) langUkBtn.addEventListener('click', ()=>{ applyLanguage('uk'); langOptions.classList.add('hidden'); render(); });

// --- MULTI SAVINGS GOALS ---
let savingsGoals = JSON.parse(localStorage.getItem('bs_savings_goals') || '[]');
const addGoalForm = document.getElementById('addGoalForm');
const goalsContainer = document.getElementById('goalsContainer');

function saveGoals() {
  localStorage.setItem('bs_savings_goals', JSON.stringify(savingsGoals));
  renderGoals();
}

if (addGoalForm) {
  addGoalForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const name = document.getElementById('newGoalName').value.trim();
    const amount = parseFloat(document.getElementById('newGoalAmount').value) || 0;
    if (!name || amount <= 0) return alert('Enter valid goal name and amount');
    if (savingsGoals.some(g => g.name.toLowerCase() === name.toLowerCase())) return alert('Goal already exists');
    savingsGoals.push({ name, target: amount });
    addGoalForm.reset();
    saveGoals();
  });
}

function renderGoals() {
  goalsContainer.innerHTML = '';
  const locale = currentLang === 'uk' ? 'uk-UA' : 'en-IE';

  savingsGoals.forEach(goal => {
    const savingsTx = transactions.filter(t => t.category.toLowerCase() === goal.name.toLowerCase());
    const totalSaved = savingsTx.reduce((sum, t) => t.type === 'income' ? sum + t.amount : sum - t.amount, 0);
    const percent = goal.target > 0 ? Math.min(100, Math.round((totalSaved / goal.target) * 100)) : 0;
    const left = Math.max(0, goal.target - totalSaved);

    const card = document.createElement('div');
    card.className = 'p-3 rounded-2xl border border-slate-200 dark:border-slate-700';
    card.innerHTML = `
      <div class="flex items-center justify-between mb-2">
        <div><div class="text-sm text-slate-400">Goal name</div><div class="text-base font-semibold">${goal.name}</div></div>
        <div><div class="text-sm text-slate-400">Goal</div><div class="text-base font-semibold">${goal.target.toLocaleString(locale,{style:'currency',currency:'EUR'})}</div></div>
      </div>
      <div class="flex items-center justify-between mb-2">
        <div><div class="text-sm text-slate-400">Current saved</div><div class="text-lg font-semibold">${totalSaved.toLocaleString(locale,{style:'currency',currency:'EUR'})}</div></div>
        <div><div class="text-sm text-slate-400">Left:</div><div class="text-lg font-semibold">${left.toLocaleString(locale,{style:'currency',currency:'EUR'})}</div></div>
      </div>
      <div class="w-full bg-slate-200 dark:bg-slate-800 h-3 rounded-full overflow-hidden">
        <div class="h-3 rounded-full bg-gradient-to-r from-primary to-accent" style="width:${percent}%;"></div>
      </div>
      <div class="flex items-center gap-2 text-sm text-slate-400 mt-1"><span>${percent}%</span></div>`;
    goalsContainer.appendChild(card);
  });
}

// Integrate with render()
const originalRender = render;
render = function() {
  originalRender();
  renderGoals();
};


</script><script type="module">
  // ‚úÖ Import Firebase SDKs
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-analytics.js";
  import { getAuth, GoogleAuthProvider, signInWithPopup, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";

  // ‚úÖ Your Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyBj5JC2OUp2QVswlTDEkpBXCDPcywXZdxk",
    authDomain: "budget-and-savings-tracker.firebaseapp.com",
    projectId: "budget-and-savings-tracker",
    storageBucket: "budget-and-savings-tracker.firebasestorage.app",
    messagingSenderId: "52076852008",
    appId: "1:52076852008:web:117a7b3071c46a677c561d",
    measurementId: "G-N8DL03R0H1"
  };

  // ‚úÖ Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();

  // ‚úÖ Reference your sidebar button
  const loginBtn = document.getElementById("signupBtn");

  // ‚úÖ Listen for auth state changes (user login/logout)
  onAuthStateChanged(auth, (user) => {
    if (user) {
      loginBtn.textContent = `Sign out (${user.displayName || user.email})`;
      loginBtn.onclick = async () => {
        await signOut(auth);
        console.log("Signed out");
      };
      console.log("Signed in as:", user);
    } else {
      loginBtn.textContent = "Sign in with Google";
      loginBtn.onclick = async () => {
        try {
          await signInWithPopup(auth, provider);
        } catch (error) {
          console.error("Error signing in:", error);
          alert("Sign-in failed: " + error.message);
        }
      };
    }
  });
</script>
<script>
  document.getElementById('upgradeBtn').addEventListener('click', function() {
    // ‚úÖ This opens your Stripe checkout in a new tab
    window.open('https://buy.stripe.com/4gM8wIc5a0Ss6m1chLcZa00', '_blank', 'noopener');
  });
</script>


</body>
</html>



